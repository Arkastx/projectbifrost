<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Bifrost - Uma Stats</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/app.css?v=20260125">
</head>
<body>
    <div class="container">
        <header>
            <h1>Project Bifrost</h1>
            <div class="header-controls">
                <label class="header-toggle">
                    <input type="checkbox" id="always-on-top-toggle">
                    Always on top
                </label>
                <div class="status">
                    <span id="status-text">Disconnected</span>
                    <div class="status-dot" id="status-dot"></div>
                </div>
            </div>
        </header>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" data-tab="training">Training</button>
            <button class="tab" data-tab="stats">Stats</button>
            <button class="tab" data-tab="race">Race</button>
            <button class="tab" data-tab="veteran-umalator">Veteran</button>
            <button class="tab" data-tab="veteran-sparks">Veteran Sparks</button>
            <button class="tab" data-tab="raw">Raw Data</button>
            <button class="tab" data-tab="settings">Settings</button>
            <button class="tab" data-tab="debug">Debug</button>
        </div>

        <!-- Tab: Training -->
        <div class="tab-content active" id="tab-training">
            <div class="training-topbar">
                <div class="training-topbar-left">
                    <div class="training-pill rest" id="rest-pill">REST</div>
                    <div class="training-slot">
                        <div class="training-slot-label">Turn</div>
                        <div class="training-slot-value" id="session-turn">0/0</div>
                        <div class="training-slot-sub" id="session-date">-</div>
                        <div class="training-slot-sub scenario" id="session-scenario">-</div>
                    </div>
                </div>
                <div class="training-topbar-center">
                    <div class="training-slot energy">
                        <div class="training-slot-label">Energy</div>
                        <div class="training-slot-value" id="session-energy">0/0</div>
                        <div class="energy-row">
                            <div class="energy-bar">
                                <div class="energy-fill" id="session-energy-bar"></div>
                            </div>
                        </div>
                    </div>
                    <div class="training-slot">
                        <div class="training-slot-label">Motivation</div>
                        <div class="motivation-bubble normal" id="session-motivation">Normal</div>
                    </div>
                    <div class="training-slot">
                        <div class="training-slot-label">Skill Pts</div>
                        <div class="training-slot-value" id="session-skillpts">0</div>
                    </div>
                    <div class="training-slot">
                        <div class="training-slot-label">Fans</div>
                        <div class="training-slot-value" id="session-fans">0</div>
                    </div>
                </div>
                <div class="training-topbar-right">
                    <div class="training-pill training-status">
                        <div class="training-pill-content">
                            <div class="training-pill-title">Training</div>
                            <div class="training-pill-next" id="session-next-race">Next race -</div>
                        </div>
                        <img class="training-pill-icon" id="session-next-icon" alt="next race">
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Supporters</h2>
                <div class="supporter-list" id="supporter-list"></div>
            </div>

            <div class="card">
                <h2>Training</h2>
                <div class="training-strip">
                    <div class="training-card stat-speed" id="card-speed">
                        <div class="training-card-top">
                            <span class="training-level" id="level-speed">Lv1</span>
                            <span class="training-fail fail-0" id="fail-speed">0%</span>
                        </div>
                        <div class="training-badges">
                            <span class="badge badge-hint" id="hints-speed">Hints 0</span>
                            <span class="badge badge-rainbow" id="rain-speed">Rainbows 0</span>
                            <span class="badge badge-risk hidden" id="risk-speed">High risk</span>
                            <span class="badge badge-highbond hidden" id="bond-speed">High bond</span>
                        </div>
                        <div class="training-label" id="label-speed">
                            <img class="stat-label-icon" id="label-icon-speed" src="/assets/icons/status_00.png" alt="speed">
                            <span>Speed</span>
                        </div>
                        <div class="training-rb" id="rb-speed">RB:0</div>
                        <div class="training-value">
                            <img class="stat-rank-icon" id="rank-icon-speed" src="/assets/icons/statusrank/ui_statusrank_00.png" alt="rank">
                            <span class="stat-number-group">
                                <span class="stat-main" id="stat-speed">0</span>
                                <span class="stat-sup" id="total-speed">+0</span>
                                <span class="stat-sub" id="max-speed">/1200</span>
                            </span>
                        </div>
                        <div class="training-gains" id="gains-speed">+0 SPD +0 POW</div>
                        <div class="training-metrics" id="metrics-speed">-0 ENERGY -0% FAIL</div>
                        <div class="training-hint-count" id="hintcount-speed">Hints 0</div>
                        <div class="training-unity-count" id="unitycount-speed">Useful Unity 0</div>
                        <div class="training-supporter-line" id="supporters-line-speed"></div>
                        <div class="training-breakdown" id="breakdown-speed"></div>
                        <div class="training-costs">
                            <div class="cost-item"><span class="cost-value" id="cost-energy-speed">Energy 0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-fail-speed">Fail 0%</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-bond-speed">Bond +0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-useful-speed">Useful +0</span></div>
                        </div>
                        <div class="training-supporters" id="supp-speed"></div>
                    </div>

                    <div class="training-card stat-stamina" id="card-stamina">
                        <div class="training-card-top">
                            <span class="training-level" id="level-stamina">Lv1</span>
                            <span class="training-fail fail-0" id="fail-stamina">0%</span>
                        </div>
                        <div class="training-badges">
                            <span class="badge badge-hint" id="hints-stamina">Hints 0</span>
                            <span class="badge badge-rainbow" id="rain-stamina">Rainbows 0</span>
                            <span class="badge badge-risk hidden" id="risk-stamina">High risk</span>
                            <span class="badge badge-highbond hidden" id="bond-stamina">High bond</span>
                        </div>
                        <div class="training-label" id="label-stamina">
                            <img class="stat-label-icon" id="label-icon-stamina" src="/assets/icons/status_01.png" alt="stamina">
                            <span>Stamina</span>
                        </div>
                        <div class="training-rb" id="rb-stamina">RB:0</div>
                        <div class="training-value">
                            <img class="stat-rank-icon" id="rank-icon-stamina" src="/assets/icons/statusrank/ui_statusrank_00.png" alt="rank">
                            <span class="stat-number-group">
                                <span class="stat-main" id="stat-stamina">0</span>
                                <span class="stat-sup" id="total-stamina">+0</span>
                                <span class="stat-sub" id="max-stamina">/1200</span>
                            </span>
                        </div>
                        <div class="training-gains" id="gains-stamina">+0 STA +0 GUT</div>
                        <div class="training-metrics" id="metrics-stamina">-0 ENERGY -0% FAIL</div>
                        <div class="training-hint-count" id="hintcount-stamina">Hints 0</div>
                        <div class="training-unity-count" id="unitycount-stamina">Useful Unity 0</div>
                        <div class="training-supporter-line" id="supporters-line-stamina"></div>
                        <div class="training-breakdown" id="breakdown-stamina"></div>
                        <div class="training-costs">
                            <div class="cost-item"><span class="cost-value" id="cost-energy-stamina">Energy 0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-fail-stamina">Fail 0%</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-bond-stamina">Bond +0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-useful-stamina">Useful +0</span></div>
                        </div>
                        <div class="training-supporters" id="supp-stamina"></div>
                    </div>

                    <div class="training-card stat-power" id="card-power">
                        <div class="training-card-top">
                            <span class="training-level" id="level-power">Lv1</span>
                            <span class="training-fail fail-0" id="fail-power">0%</span>
                        </div>
                        <div class="training-badges">
                            <span class="badge badge-hint" id="hints-power">Hints 0</span>
                            <span class="badge badge-rainbow" id="rain-power">Rainbows 0</span>
                            <span class="badge badge-risk hidden" id="risk-power">High risk</span>
                            <span class="badge badge-highbond hidden" id="bond-power">High bond</span>
                        </div>
                        <div class="training-label" id="label-power">
                            <img class="stat-label-icon" id="label-icon-power" src="/assets/icons/status_02.png" alt="power">
                            <span>Power</span>
                        </div>
                        <div class="training-rb" id="rb-power">RB:0</div>
                        <div class="training-value">
                            <img class="stat-rank-icon" id="rank-icon-power" src="/assets/icons/statusrank/ui_statusrank_00.png" alt="rank">
                            <span class="stat-number-group">
                                <span class="stat-main" id="stat-power">0</span>
                                <span class="stat-sup" id="total-power">+0</span>
                                <span class="stat-sub" id="max-power">/1200</span>
                            </span>
                        </div>
                        <div class="training-gains" id="gains-power">+0 POW +0 STA</div>
                        <div class="training-metrics" id="metrics-power">-0 ENERGY -0% FAIL</div>
                        <div class="training-hint-count" id="hintcount-power">Hints 0</div>
                        <div class="training-unity-count" id="unitycount-power">Useful Unity 0</div>
                        <div class="training-supporter-line" id="supporters-line-power"></div>
                        <div class="training-breakdown" id="breakdown-power"></div>
                        <div class="training-costs">
                            <div class="cost-item"><span class="cost-value" id="cost-energy-power">Energy 0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-fail-power">Fail 0%</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-bond-power">Bond +0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-useful-power">Useful +0</span></div>
                        </div>
                        <div class="training-supporters" id="supp-power"></div>
                    </div>

                    <div class="training-card stat-guts" id="card-guts">
                        <div class="training-card-top">
                            <span class="training-level" id="level-guts">Lv1</span>
                            <span class="training-fail fail-0" id="fail-guts">0%</span>
                        </div>
                        <div class="training-badges">
                            <span class="badge badge-hint" id="hints-guts">Hints 0</span>
                            <span class="badge badge-rainbow" id="rain-guts">Rainbows 0</span>
                            <span class="badge badge-risk hidden" id="risk-guts">High risk</span>
                            <span class="badge badge-highbond hidden" id="bond-guts">High bond</span>
                        </div>
                        <div class="training-label" id="label-guts">
                            <img class="stat-label-icon" id="label-icon-guts" src="/assets/icons/status_03.png" alt="guts">
                            <span>Guts</span>
                        </div>
                        <div class="training-rb" id="rb-guts">RB:0</div>
                        <div class="training-value">
                            <img class="stat-rank-icon" id="rank-icon-guts" src="/assets/icons/statusrank/ui_statusrank_00.png" alt="rank">
                            <span class="stat-number-group">
                                <span class="stat-main" id="stat-guts">0</span>
                                <span class="stat-sup" id="total-guts">+0</span>
                                <span class="stat-sub" id="max-guts">/1200</span>
                            </span>
                        </div>
                        <div class="training-gains" id="gains-guts">+0 GUT +0 POW +0 SPD</div>
                        <div class="training-metrics" id="metrics-guts">-0 ENERGY -0% FAIL</div>
                        <div class="training-hint-count" id="hintcount-guts">Hints 0</div>
                        <div class="training-unity-count" id="unitycount-guts">Useful Unity 0</div>
                        <div class="training-supporter-line" id="supporters-line-guts"></div>
                        <div class="training-breakdown" id="breakdown-guts"></div>
                        <div class="training-costs">
                            <div class="cost-item"><span class="cost-value" id="cost-energy-guts">Energy 0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-fail-guts">Fail 0%</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-bond-guts">Bond +0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-useful-guts">Useful +0</span></div>
                        </div>
                        <div class="training-supporters" id="supp-guts"></div>
                    </div>

                    <div class="training-card stat-wit" id="card-wit">
                        <div class="training-card-top">
                            <span class="training-level" id="level-wit">Lv1</span>
                            <span class="training-fail fail-0" id="fail-wit">0%</span>
                        </div>
                        <div class="training-badges">
                            <span class="badge badge-hint" id="hints-wit">Hints 0</span>
                            <span class="badge badge-rainbow" id="rain-wit">Rainbows 0</span>
                            <span class="badge badge-risk hidden" id="risk-wit">High risk</span>
                            <span class="badge badge-highbond hidden" id="bond-wit">High bond</span>
                        </div>
                        <div class="training-label" id="label-wit">
                            <img class="stat-label-icon" id="label-icon-wit" src="/assets/icons/status_04.png" alt="wit">
                            <span>Wit</span>
                        </div>
                        <div class="training-rb" id="rb-wit">RB:0</div>
                        <div class="training-value">
                            <img class="stat-rank-icon" id="rank-icon-wit" src="/assets/icons/statusrank/ui_statusrank_00.png" alt="rank">
                            <span class="stat-number-group">
                                <span class="stat-main" id="stat-wisdom">0</span>
                                <span class="stat-sup" id="total-wit">+0</span>
                                <span class="stat-sub" id="max-wit">/1200</span>
                            </span>
                        </div>
                        <div class="training-gains" id="gains-wit">+0 WIT +0 SKL</div>
                        <div class="training-metrics" id="metrics-wit">-0 ENERGY -0% FAIL</div>
                        <div class="training-hint-count" id="hintcount-wit">Hints 0</div>
                        <div class="training-unity-count" id="unitycount-wit">Useful Unity 0</div>
                        <div class="training-supporter-line" id="supporters-line-wit"></div>
                        <div class="training-breakdown" id="breakdown-wit"></div>
                        <div class="training-costs">
                            <div class="cost-item"><span class="cost-value" id="cost-energy-wit">Energy 0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-fail-wit">Fail 0%</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-bond-wit">Bond +0</span></div>
                            <div class="cost-item"><span class="cost-value" id="cost-useful-wit">Useful +0</span></div>
                        </div>
                        <div class="training-supporters" id="supp-wit"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Stats -->
        <div class="tab-content" id="tab-stats">
            <div class="card ui-layout-item" data-ui-id="stats-card">
                <h2>Stats</h2>
                <div class="skills-header">
                    <img class="skills-portrait" id="skills-portrait" alt="portrait">
                    <div>
                        <div class="skills-name" id="skills-name">Unknown</div>
                        <div class="skills-sub" id="skills-talent">Potential Lv 0</div>
                        <div class="skills-sub" id="skills-style">Running Style: -</div>
                    </div>
                </div>

                <div class="skills-stat-strip">
                    <div class="skills-stat">
                        <div class="skills-stat-header">
                            <img class="stat-icon" id="stat-icon-speed" alt="speed">
                            <span>Speed</span>
                        </div>
                        <div class="skills-stat-body">
                            <img class="skills-rank-icon" id="rank-speed" alt="rank">
                            <div>
                                <div class="skills-stat-value" id="skills-stat-speed">0</div>
                                <div class="skills-stat-max" id="skills-max-speed">/1200</div>
                            </div>
                        </div>
                    </div>
                    <div class="skills-stat">
                        <div class="skills-stat-header">
                            <img class="stat-icon" id="stat-icon-stamina" alt="stamina">
                            <span>Stamina</span>
                        </div>
                        <div class="skills-stat-body">
                            <img class="skills-rank-icon" id="rank-stamina" alt="rank">
                            <div>
                                <div class="skills-stat-value" id="skills-stat-stamina">0</div>
                                <div class="skills-stat-max" id="skills-max-stamina">/1200</div>
                            </div>
                        </div>
                    </div>
                    <div class="skills-stat">
                        <div class="skills-stat-header">
                            <img class="stat-icon" id="stat-icon-power" alt="power">
                            <span>Power</span>
                        </div>
                        <div class="skills-stat-body">
                            <img class="skills-rank-icon" id="rank-power" alt="rank">
                            <div>
                                <div class="skills-stat-value" id="skills-stat-power">0</div>
                                <div class="skills-stat-max" id="skills-max-power">/1200</div>
                            </div>
                        </div>
                    </div>
                    <div class="skills-stat">
                        <div class="skills-stat-header">
                            <img class="stat-icon" id="stat-icon-guts" alt="guts">
                            <span>Guts</span>
                        </div>
                        <div class="skills-stat-body">
                            <img class="skills-rank-icon" id="rank-guts" alt="rank">
                            <div>
                                <div class="skills-stat-value" id="skills-stat-guts">0</div>
                                <div class="skills-stat-max" id="skills-max-guts">/1200</div>
                            </div>
                        </div>
                    </div>
                    <div class="skills-stat">
                        <div class="skills-stat-header">
                            <img class="stat-icon" id="stat-icon-wit" alt="wit">
                            <span>Wit</span>
                        </div>
                        <div class="skills-stat-body">
                            <img class="skills-rank-icon" id="rank-wit" alt="rank">
                            <div>
                                <div class="skills-stat-value" id="skills-stat-wit">0</div>
                                <div class="skills-stat-max" id="skills-max-wit">/1200</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="aptitude-grid">
                <div class="aptitude-group">
                    <div class="aptitude-title">Track</div>
                    <div class="aptitude-row">
                        <span class="apt-badge" id="apt-turf">-</span>
                        <span class="apt-badge" id="apt-dirt">-</span>
                    </div>
                </div>
                <div class="aptitude-group">
                    <div class="aptitude-title">Distance</div>
                    <div class="aptitude-row">
                        <span class="apt-badge" id="apt-sprint">-</span>
                        <span class="apt-badge" id="apt-mile">-</span>
                        <span class="apt-badge" id="apt-medium">-</span>
                        <span class="apt-badge" id="apt-long">-</span>
                    </div>
                </div>
                <div class="aptitude-group">
                    <div class="aptitude-title">Style</div>
                    <div class="aptitude-row">
                        <span class="apt-badge" id="apt-front">-</span>
                        <span class="apt-badge" id="apt-pace">-</span>
                        <span class="apt-badge" id="apt-late">-</span>
                        <span class="apt-badge" id="apt-end">-</span>
                    </div>
                </div>
                </div>

                <div class="skills-growth" id="skills-growth">
                    <span class="growth-pill">Growth: -</span>
                </div>

                <div class="skills-section">
                    <h3>Skills Current</h3>
                    <div class="skills-list" id="skills-owned">
                        <span class="skills-empty">No skills data available</span>
                    </div>
                </div>
                <div class="skills-section">
                    <h3 id="skills-available-title">Available Skills (0 SP)</h3>
                    <div class="skills-list" id="skills-tips">
                        <span class="skills-empty">No tips available</span>
                    </div>
                </div>
                <details class="skills-section">
                    <summary>Raw Stats JSON</summary>
                    <pre class="skills-raw" id="skills-raw-json">{}</pre>
                </details>
                <div class="skills-section">
                    <h3>Conditions</h3>
                    <div class="skills-list" id="skills-conditions">
                        <span class="skills-empty">Nothing of note</span>
                    </div>
                </div>
            </div>
            <div class="card ui-layout-item optimizer-card" data-ui-id="stats-optimizer-card">
                <h2>Optimizer</h2>
                <div class="settings-row">
                    <span class="settings-label">Race Preset</span>
                    <select class="settings-select" id="stats-preset-select">
                        <option value="">Loading presets...</option>
                    </select>
                </div>
                <div class="settings-row">
                    <span class="settings-label">Running Style</span>
                    <select class="settings-select" id="stats-style-select">
                        <option value="auto">Auto (from game)</option>
                        <option value="Front">Front</option>
                        <option value="Pace">Pace</option>
                        <option value="Late">Late</option>
                        <option value="End">End</option>
                    </select>
                </div>
                <div class="settings-row optimizer-targets">
                    <label class="optimizer-target">
                        <span>Survival Target %</span>
                        <input type="number" id="optimizer-target-survival" value="50" min="0" max="100" step="1">
                    </label>
                    <label class="optimizer-target">
                        <span>Spurt Target %</span>
                        <input type="number" id="optimizer-target-spurt" value="50" min="0" max="100" step="1">
                    </label>
                    <label class="optimizer-target">
                        <span>Final Leg Target %</span>
                        <input type="number" id="optimizer-target-finalleg" value="0" min="0" max="100" step="1">
                    </label>
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="stats-open-umalator">Check in Umalator</button>
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="stats-umalator-check">Run Compare Check</button>
                </div>
                <div class="settings-row">
                    <div class="umalator-check-results" id="stats-umalator-results">
                        <div class="umalator-check-line">Selected Skills Win Rate: --</div>
                        <div class="umalator-check-line">Current Build Win Rate: --</div>
                        <div class="umalator-check-line">Draw Rate: --</div>
                    </div>
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="optimizer-generate-builds">Generate Builds</button>
                </div>
                <div class="settings-row">
                    <span class="settings-label">Builds</span>
                    <select class="settings-select" id="optimizer-build-select">
                        <option value="">No builds</option>
                    </select>
                </div>
                <div class="settings-row">
                    <div class="optimizer-build-summary" id="optimizer-build-summary">No build selected</div>
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="stats-clear-state">Delete Last State</button>
                </div>
            </div>
        </div><!-- Tab: Race -->
        <div class="tab-content" id="tab-race">
            <div class="card ui-layout-item" data-ui-id="race-card-combined">
                <h2>Race Agenda</h2>
                <div class="race-toggle">
                    <label><input type="checkbox" id="toggle-objectives">Show objectives (separate)</label>
                    <label><input type="checkbox" id="toggle-agenda">Show agenda (separate)</label>
                </div>
                <div class="race-list" id="race-combined">
                    <span class="skills-empty">No race data available</span>
                </div>
            </div>
            <div class="card ui-layout-item" id="objective-card" style="display: none;" data-ui-id="race-card-objectives">
                <h2>Objectives (separate)</h2>
                <div class="race-list" id="objective-list">
                    <span class="skills-empty">No objectives available</span>
                </div>
            </div>
            <div class="card ui-layout-item" id="agenda-card" style="display: none;" data-ui-id="race-card-agenda">
                <h2>Race Agenda (separate)</h2>
                <div class="race-list" id="race-list">
                    <span class="skills-empty">No race data available</span>
                </div>
            </div>
            <div class="card">
                <h2>Event Choices</h2>
                <div id="event-choices">
                    <span class="skills-empty">No event choices available</span>
                </div>
            </div>
        </div>

        <!-- Tab: Misc -->
        <div class="tab-content" id="tab-misc">
            <div class="card ui-layout-item" data-ui-id="misc-card">
                <h2>Misc Data</h2>
                <div id="misc-grid" class="misc-grid">
                    <span class="skills-empty">No misc data available</span>
                </div>
            </div>
        </div>

        <!-- Tab: Veteran Umalator -->
        <div class="tab-content" id="tab-veteran-umalator">
            <div class="card ui-layout-item" id="veteran-detail-card" style="display:none;" data-ui-id="veteran-detail-card">
                <h2>Veteran Details</h2>
                <div id="veteran-detail-empty" class="skills-empty">Select a horse to view details</div>
                <div id="veteran-detail" style="display:none;">
                    <div class="skills-header">
                        <img class="skills-portrait" id="veteran-portrait" alt="portrait">
                        <div>
                    <div class="skills-name" id="veteran-name">Unknown</div>
                    <div class="skills-sub" id="veteran-rank"></div>
                    <div class="skills-sub" id="veteran-style"></div>
                    <div class="skills-section">
                        <button class="filters-button" id="veteran-uma1">Select as Uma 1</button>
                        <button class="filters-button" id="veteran-uma2">Select as Uma 2</button>
                    </div>
                </div>
            </div>

                    <div class="skills-stat-strip">
                        <div class="skills-stat">
                            <div class="skills-stat-header">
                                <img class="stat-icon" id="vstat-icon-speed" alt="speed">
                                <span>Speed</span>
                            </div>
                            <div class="skills-stat-body">
                                <img class="skills-rank-icon" id="vrank-speed" alt="rank">
                                <div>
                                    <div class="skills-stat-value" id="vstat-speed">0</div>
                                    <div class="skills-stat-max" id="vmax-speed">/1200</div>
                                </div>
                            </div>
                        </div>
                        <div class="skills-stat">
                            <div class="skills-stat-header">
                                <img class="stat-icon" id="vstat-icon-stamina" alt="stamina">
                                <span>Stamina</span>
                            </div>
                            <div class="skills-stat-body">
                                <img class="skills-rank-icon" id="vrank-stamina" alt="rank">
                                <div>
                                    <div class="skills-stat-value" id="vstat-stamina">0</div>
                                    <div class="skills-stat-max" id="vmax-stamina">/1200</div>
                                </div>
                            </div>
                        </div>
                        <div class="skills-stat">
                            <div class="skills-stat-header">
                                <img class="stat-icon" id="vstat-icon-power" alt="power">
                                <span>Power</span>
                            </div>
                            <div class="skills-stat-body">
                                <img class="skills-rank-icon" id="vrank-power" alt="rank">
                                <div>
                                    <div class="skills-stat-value" id="vstat-power">0</div>
                                    <div class="skills-stat-max" id="vmax-power">/1200</div>
                                </div>
                            </div>
                        </div>
                        <div class="skills-stat">
                            <div class="skills-stat-header">
                                <img class="stat-icon" id="vstat-icon-guts" alt="guts">
                                <span>Guts</span>
                            </div>
                            <div class="skills-stat-body">
                                <img class="skills-rank-icon" id="vrank-guts" alt="rank">
                                <div>
                                    <div class="skills-stat-value" id="vstat-guts">0</div>
                                    <div class="skills-stat-max" id="vmax-guts">/1200</div>
                                </div>
                            </div>
                        </div>
                        <div class="skills-stat">
                            <div class="skills-stat-header">
                                <img class="stat-icon" id="vstat-icon-wit" alt="wit">
                                <span>Wit</span>
                            </div>
                            <div class="skills-stat-body">
                                <img class="skills-rank-icon" id="vrank-wit" alt="rank">
                                <div>
                                    <div class="skills-stat-value" id="vstat-wit">0</div>
                                    <div class="skills-stat-max" id="vmax-wit">/1200</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="aptitude-grid">
                        <div class="aptitude-group">
                            <div class="aptitude-title">Track</div>
                            <div class="aptitude-row">
                                <span class="apt-badge" id="vapt-turf">-</span>
                                <span class="apt-badge" id="vapt-dirt">-</span>
                            </div>
                        </div>
                        <div class="aptitude-group">
                            <div class="aptitude-title">Distance</div>
                            <div class="aptitude-row">
                                <span class="apt-badge" id="vapt-sprint">-</span>
                                <span class="apt-badge" id="vapt-mile">-</span>
                                <span class="apt-badge" id="vapt-medium">-</span>
                                <span class="apt-badge" id="vapt-long">-</span>
                            </div>
                        </div>
                        <div class="aptitude-group">
                            <div class="aptitude-title">Style</div>
                            <div class="aptitude-row">
                                <span class="apt-badge" id="vapt-front">-</span>
                                <span class="apt-badge" id="vapt-pace">-</span>
                                <span class="apt-badge" id="vapt-late">-</span>
                                <span class="apt-badge" id="vapt-end">-</span>
                            </div>
                        </div>
                    </div>

                    <div class="skills-section">
                        <h3>Skills Current</h3>
                        <div class="skills-list" id="veteran-skills">
                            <span class="skills-empty">No skills data available</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card ui-layout-item" data-ui-id="veteran-horses-card">
                <h2>Veteran Horses</h2>
                <div class="settings-row">
                    <button class="filters-button" id="veteran-filters-open">Filters</button>
                    <span class="filters-summary" id="veteran-filters-summary">No filters</span>
                </div>
                <div class="settings-row">
                    <label>Search</label>
                    <input class="settings-select" id="veteran-search" type="text" placeholder="Name, title, subtitle...">
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="veteran-open-umalator">Show in Umalator</button>
                    <select class="settings-select" id="veteran-preset-select">
                        <option value="">Loading presets...</option>
                    </select>
                </div>
                <div class="umalator-slots" style="display:none;">
                    <div class="umalator-slot">
                        <strong>Uma 1</strong>
                        <div id="umalator-slot-1">No selection</div>
                    </div>
                    <div class="umalator-slot">
                        <strong>Uma 2</strong>
                        <div id="umalator-slot-2">No selection</div>
                    </div>
                </div>
                <div id="veteran-list" class="skills-list veteran-list-grid">
                    <span class="skills-empty">No veteran data available</span>
                </div>
            </div>
        </div>

        <!-- Tab: Veteran Sparks -->
        <div class="tab-content" id="tab-veteran-sparks">
            <div class="card ui-layout-item" data-ui-id="veteran-sparks-card">
                <h2>Veteran Sparks</h2>
                <span class="skills-empty">Spark sorting will live here.</span>
            </div>
        </div>

        <div class="veteran-modal" id="veteran-filters-modal" style="display:none;">
            <div class="veteran-modal-content">
                <h2>Filters</h2>
                <div class="filters-grid">
                    <div class="filters-row">
                        <span class="settings-label">Sort</span>
                        <select class="settings-select" id="veteran-sort">
                            <option value="rank_score">Rank Score</option>
                            <option value="skill_count">Skill Count</option>
                            <option value="rank">Rank</option>
                            <option value="fans">Fans</option>
                            <option value="speed">Speed</option>
                            <option value="stamina">Stamina</option>
                            <option value="power">Power</option>
                            <option value="guts">Guts</option>
                            <option value="wit">Wit</option>
                        </select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Order</span>
                        <select class="settings-select" id="veteran-sort-order">
                            <option value="desc">High to Low</option>
                            <option value="asc">Low to High</option>
                        </select>
                    </div>
                    <div class="filters-row">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="veteran-filter-locked">
                            Show locked only
                        </label>
                    </div>
                    <div class="filters-row">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="veteran-filter-favorite">
                            Show favorites only
                        </label>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Turf >=</span>
                        <select class="settings-select" id="veteran-filter-turf"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Dirt >=</span>
                        <select class="settings-select" id="veteran-filter-dirt"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Sprint >=</span>
                        <select class="settings-select" id="veteran-filter-sprint"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Mile >=</span>
                        <select class="settings-select" id="veteran-filter-mile"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Medium >=</span>
                        <select class="settings-select" id="veteran-filter-medium"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Long >=</span>
                        <select class="settings-select" id="veteran-filter-long"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Front >=</span>
                        <select class="settings-select" id="veteran-filter-front"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Pace >=</span>
                        <select class="settings-select" id="veteran-filter-pace"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">Late >=</span>
                        <select class="settings-select" id="veteran-filter-late"></select>
                    </div>
                    <div class="filters-row">
                        <span class="settings-label">End >=</span>
                        <select class="settings-select" id="veteran-filter-end"></select>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="veteran-filters-apply">Apply</button>
                    <button id="veteran-filters-close">Close</button>
                </div>
            </div>
        </div>

        <div class="veteran-modal" id="veteran-error-modal" style="display:none;">
            <div class="veteran-modal-content">
                <h2>Umalator</h2>
                <div id="veteran-error-message" class="skills-empty">Select Uma 1 and Uma 2 first.</div>
                <div class="modal-actions">
                    <button id="veteran-error-close">OK</button>
                </div>
            </div>
        </div>

        <!-- Tab: Raw Data -->
        <div class="tab-content" id="tab-raw">
            <div class="card ui-layout-item" data-ui-id="raw-card">
                <h2>Raw Game Data</h2>
                <pre id="raw-data">Waiting for data...</pre>
            </div>
        </div>

        <!-- Tab: Settings -->
        <div class="tab-content" id="tab-settings">
            <div class="card ui-layout-item" data-ui-id="settings-card">
                <h2>Settings</h2>
                <div class="settings-row">
                    <button class="filters-button" id="settings-save">Save</button>
                    <span class="filters-summary" id="settings-status">Not saved</span>
                </div>
                <div class="settings-row">
                    <span class="settings-label">Font</span>
                    <select class="settings-select" id="setting-font">
                        <option value="'Inter', 'IBM Plex Sans', system-ui, -apple-system, 'Segoe UI', sans-serif">Inter (Default)</option>
                        <option value="'IBM Plex Sans', 'Inter', system-ui, -apple-system, 'Segoe UI', sans-serif">IBM Plex Sans</option>
                        <option value="'Noto Sans JP', 'Inter', system-ui, sans-serif">Noto Sans JP</option>
                        <option value="-apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif">System Default</option>
                        <option value="'Segoe UI', sans-serif">Segoe UI</option>
                        <option value="Arial, sans-serif">Arial</option>
                        <option value="monospace">Monospace</option>
                    </select>
                </div>
                <div class="settings-subtitle">Suggested Training (Calculator)</div>
                <div class="settings-row">
                    <span class="settings-label">Calculator</span>
                    <select class="settings-select" id="setting-calc-enabled">
                        <option value="on">On</option>
                        <option value="off">Off</option>
                    </select>
                </div>
                <div class="settings-grid">
                    <div class="settings-row">
                        <span class="settings-label">Weight: Speed</span>
                        <input class="settings-select" id="setting-calc-weight-speed" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Stamina</span>
                        <input class="settings-select" id="setting-calc-weight-stamina" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Power</span>
                        <input class="settings-select" id="setting-calc-weight-power" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Guts</span>
                        <input class="settings-select" id="setting-calc-weight-guts" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Wit</span>
                        <input class="settings-select" id="setting-calc-weight-wit" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Skill Pts</span>
                        <input class="settings-select" id="setting-calc-weight-skill" type="number" step="0.1" style="display:none">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Bond</span>
                        <input class="settings-select" id="setting-calc-weight-bond" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Weight: Useful Bond</span>
                        <input class="settings-select" id="setting-calc-weight-useful" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Penalty: Energy</span>
                        <input class="settings-select" id="setting-calc-weight-energy" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Penalty: Fail %</span>
                        <input class="settings-select" id="setting-calc-weight-fail" type="number" step="0.1">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Threshold: Fail %</span>
                        <input class="settings-select" id="setting-calc-threshold-fail" type="number" step="1" min="0" max="100">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Threshold: Energy</span>
                        <input class="settings-select" id="setting-calc-threshold-energy" type="number" step="1" min="0" max="100">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Threshold: Useful Bond</span>
                        <input class="settings-select" id="setting-calc-threshold-useful" type="number" step="1" min="0" max="100">
                    </div>
                </div>
                <div class="settings-row">
                    <button class="filters-button" id="settings-advanced-toggle">Advanced Settings</button>
                </div>
                <div id="settings-advanced" style="display:none;">
                    <div class="settings-row">
                        <span class="settings-label">UDP Host</span>
                        <input class="settings-select" id="setting-udp-host" type="text">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">UDP Port</span>
                        <input class="settings-select" id="setting-udp-port" type="number" min="1" max="65535">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Web Host</span>
                        <input class="settings-select" id="setting-web-host" type="text">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Web Port</span>
                        <input class="settings-select" id="setting-web-port" type="number" min="1" max="65535">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Max Buffer Size</span>
                        <input class="settings-select" id="setting-max-buffer" type="number" min="1024">
                    </div>
                    <div class="settings-row">
                        <span class="settings-label">Log Level</span>
                        <select class="settings-select" id="setting-log-level">
                            <option value="DEBUG">DEBUG</option>
                            <option value="INFO">INFO</option>
                            <option value="WARNING">WARNING</option>
                            <option value="ERROR">ERROR</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab: Debug -->
        <div class="tab-content" id="tab-debug">
            <div class="card ui-layout-item" data-ui-id="debug-card">
                <h2>Debug</h2>
                <div class="info-row">
                    <span class="info-label">Last Packet</span>
                    <span id="info-packet">-</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Last Update</span>
                    <span id="info-update">-</span>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/app-core.js?v=20260130"></script>
    <script src="/static/js/app-init.js?v=20260123"></script>
</body>
</html>
